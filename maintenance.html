<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Under Maintenance - Michelle</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    @keyframes pulse-custom {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.5; }
    }
    .animate-spin-slow {
      animation: spin-slow 3s linear infinite;
    }
    .animate-pulse-custom {
      animation: pulse-custom 3s ease-in-out infinite;
    }
    .delay-1000 {
      animation-delay: 1s;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-[#40E0D0]/20 via-white to-[#40E0D0]/10 flex items-center justify-center px-4 relative overflow-hidden">
  <div class="absolute inset-0 opacity-30">
    <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-[#40E0D0]/20 rounded-full blur-3xl animate-pulse-custom"></div>
    <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-[#D4AF37]/10 rounded-full blur-3xl animate-pulse-custom delay-1000"></div>
  </div>

  <div class="max-w-2xl w-full relative z-10">
    <div class="bg-white/90 backdrop-blur-lg rounded-2xl p-8 md:p-12 border border-gray-200 shadow-2xl">
      <div class="flex justify-center mb-8">
        <div class="relative">
          <div class="absolute inset-0 bg-[#40E0D0]/20 blur-2xl rounded-full"></div>
          <div class="relative bg-gradient-to-br from-[#40E0D0] to-[#40E0D0]/80 p-6 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white animate-spin-slow">
              <path d="M12 2v4"></path>
              <path d="m16.2 7.8 2.9-2.9"></path>
              <path d="M18 12h4"></path>
              <path d="m16.2 16.2 2.9 2.9"></path>
              <path d="M12 18v4"></path>
              <path d="m4.9 19.1 2.9-2.9"></path>
              <path d="M2 12h4"></path>
              <path d="m4.9 4.9 2.9 2.9"></path>
            </svg>
          </div>
        </div>
      </div>

      <h1 class="text-4xl md:text-5xl font-semibold text-center text-black mb-4">
        Under Maintenance
      </h1>

      <p class="text-xl text-center text-gray-700 mb-8 leading-relaxed" id="maintenance-message">
        We are currently performing scheduled maintenance. Please check back soon!
      </p>

      <div id="estimated-time" class="hidden bg-[#40E0D0]/5 rounded-lg p-4 mb-8 border border-[#40E0D0]/20">
        <p class="text-center text-gray-700">
          <span class="font-semibold text-black">Expected completion:</span>
          <span id="completion-time"></span>
        </p>
      </div>

      <div class="space-y-4">
        <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent"></div>

        <div id="preview-button-container">
          <button
            onclick="showPasswordInput()"
            class="w-full flex items-center justify-center gap-2 px-6 py-3 bg-white hover:bg-gray-50 border-2 border-[#40E0D0] rounded-full text-black font-medium transition-all duration-200 hover:shadow-lg hover:shadow-[#40E0D0]/20"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            Preview Mode
          </button>
        </div>

        <form id="password-form" class="hidden space-y-4" onsubmit="handlePreviewUnlock(event)">
          <div>
            <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
              Enter Preview Password
            </label>
            <div class="relative">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                <rect width="18" height="11" x="3" y="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
              <input
                id="password"
                type="password"
                class="w-full pl-12 pr-4 py-3 bg-white border-2 border-gray-300 rounded-lg text-black placeholder-gray-400 focus:outline-none focus:border-[#40E0D0] focus:ring-2 focus:ring-[#40E0D0]/20 transition-all"
                placeholder="Enter password"
                required
              />
            </div>
            <p id="error-message" class="hidden mt-2 text-sm text-red-600"></p>
          </div>

          <div class="flex gap-3">
            <button
              type="button"
              onclick="hidePasswordInput()"
              class="flex-1 px-6 py-3 bg-white hover:bg-gray-50 border-2 border-gray-300 rounded-full text-black font-medium transition-all duration-200"
            >
              Cancel
            </button>
            <button
              type="submit"
              id="submit-button"
              class="flex-1 px-6 py-3 bg-[#40E0D0] hover:bg-[#40E0D0]/90 rounded-full text-white font-medium transition-all duration-200 hover:shadow-xl hover:shadow-[#40E0D0]/30"
            >
              Access Preview
            </button>
          </div>
        </form>
      </div>

      <div class="mt-8 pt-6 border-t border-gray-200">
        <p class="text-center text-gray-600 text-sm">
          Thank you for your patience. We'll be back online shortly.
        </p>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = 'https://ngsbdxkuwasbqxiorzgz.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nc2JkeGt1d2FzYnF4aW9yemd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk2Mzk5NDAsImV4cCI6MjA3NTIxNTk0MH0.mJMQu_9j2TlX-Hb60gVZqJRC5XV7rdi3bHjoxkWLkg8';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let maintenanceData = null;

    async function loadMaintenanceData() {
      try {
        const { data, error } = await supabase
          .from('maintenance_settings')
          .select('maintenance_message, estimated_end_time, preview_password')
          .maybeSingle();

        if (error) throw error;

        if (data) {
          maintenanceData = data;

          document.getElementById('maintenance-message').textContent = data.maintenance_message;

          if (data.estimated_end_time) {
            const timeElement = document.getElementById('completion-time');
            timeElement.textContent = ' ' + new Date(data.estimated_end_time).toLocaleString();
            document.getElementById('estimated-time').classList.remove('hidden');
          }
        }
      } catch (error) {
        console.error('Error loading maintenance data:', error);
      }
    }

    function showPasswordInput() {
      document.getElementById('preview-button-container').classList.add('hidden');
      document.getElementById('password-form').classList.remove('hidden');
      document.getElementById('password').focus();
    }

    function hidePasswordInput() {
      document.getElementById('preview-button-container').classList.remove('hidden');
      document.getElementById('password-form').classList.add('hidden');
      document.getElementById('password').value = '';
      document.getElementById('error-message').classList.add('hidden');
    }

    async function handlePreviewUnlock(event) {
      event.preventDefault();

      const password = document.getElementById('password').value;
      const errorMessage = document.getElementById('error-message');
      const submitButton = document.getElementById('submit-button');

      submitButton.disabled = true;
      submitButton.textContent = 'Verifying...';

      if (maintenanceData && password === maintenanceData.preview_password) {
        window.location.href = '/';
      } else {
        errorMessage.textContent = 'Incorrect password. Please try again.';
        errorMessage.classList.remove('hidden');
        document.getElementById('password').value = '';

        submitButton.disabled = false;
        submitButton.textContent = 'Access Preview';
      }
    }

    loadMaintenanceData();
  </script>
</body>
</html>
